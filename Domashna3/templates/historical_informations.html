<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historical Informations</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-light text-dark">
    <div class="container my-5">
        <div class="d-flex justify-content-between align-items-center">
            <h1 class="text-center">Historical Informations</h1>
            <!-- Back button -->
            <a href="/" class="btn btn-secondary">Back</a>
        </div>

        <!-- Search Form -->
        <form method="POST" class="row g-3 justify-content-center mb-5">
            <div class="col-md-4">
                <input type="text" name="stock" class="form-control" placeholder="Enter stock symbol (e.g., ALK)" value="{{ stock_name or '' }}">
            </div>
            <div class="col-md-3">
                <input type="date" name="start_date" class="form-control" value="{{ start_date or '' }}">
            </div>
            <div class="col-md-3">
                <input type="date" name="end_date" class="form-control" value="{{ end_date or '' }}">
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">Submit</button>
            </div>
        </form>

        <!-- Data Table and Chart -->
        {% if data %}
        <div class="row">
            <div class="col-md-6">
                <table class="table table-bordered table-striped text-center">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Last Price</th>
                            <th>Max</th>
                            <th>Min</th>
                            <th>Average</th>
                            <th>% Change</th>
                            <th>Quantity</th>
                            <th>Turnover in BEST</th>
                            <th>Total Turnover</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in data %}
                        <tr>
                            <td>{{ row['Датум'] }}</td>
                            <td>{{ row['Цена на последна трансакција'] }}</td>
                            <td>{{ row['Мак.'] }}</td>
                            <td>{{ row['Мин.'] }}</td>
                            <td>{{ row['Просечна цена'] }}</td>
                            <td>{{ row['%пром.'] }}</td>
                            <td>{{ row['Количина'] }}</td>
                            <td>{{ row['Промет во БЕСТ во денари'] }}</td>
                            <td>{{ row['Вкупен промет во денари'] }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="col-md-6">
                <canvas id="historicalChart"></canvas>
            </div>
        </div>
        {% endif %}
    </div>


</body>
</html>
